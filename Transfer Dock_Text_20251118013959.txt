Raja luck
<!DOCTYPE html>
<html lang="hi">
<head>
┬а┬а┬а┬а<meta charset="UTF-8">
┬а┬а┬а┬а<meta name="viewport" content="width=device-width, initial-scale=1.0">
┬а┬а┬а┬а<title>Vibrant Color & Size Predictor</title>
┬а┬а┬а┬а<!-- Tailwind CSS CDN load ho raha hai -->
┬а┬а┬а┬а<script src="https://cdn.tailwindcss.com"></script>
┬а┬а┬а┬а<style>
┬а┬а┬а┬а┬а┬а┬а┬а/* Custom Tailwind Configuration - NEW VIBRANT COLORS */
┬а┬а┬а┬а┬а┬а┬а┬аtailwind.config = {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtheme: {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аextend: {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolors: {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'primary-yellow': '#FFDD00', /* Vibrant Yellow */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'primary-red': '#FF5500', /* Bright Red/Orange */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'accent-purple': '#BB00FF',
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'dark-bg': '#121212', /* Dark Gray/Black for contrast */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'card-bg': '#202020', /* Darker card for contrast */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Default betting colors (used for history/logic only)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'actual-green': '#39FF14', 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а'actual-red': '#FF4444', 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а},
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аfontFamily: {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsans: ['Inter', 'sans-serif'],
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а</style>
┬а┬а┬а┬а<style>
┬а┬а┬а┬а┬а┬а┬а┬а/* Global Styles and Glow Effects (Red/Yellow Focus) */
┬а┬а┬а┬а┬а┬а┬а┬аbody { background-color: #121212; }
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а.text-yellow-glow { text-shadow: 0 0 5px #FFDD00, 0 0 15px #FFDD00; color: #FFDD00; }
┬а┬а┬а┬а┬а┬а┬а┬а.text-red-glow { text-shadow: 0 0 5px #FF5500, 0 0 15px #FF5500; color: #FF5500; }
┬а┬а┬а┬а┬а┬а┬а┬а.text-purple-glow { text-shadow: 0 0 5px #BB00FF, 0 0 10px #BB00FF; color: #BB00FF; }
┬а┬а┬а┬а┬а┬а┬а┬а/* Betting Button Styles - Shared */
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-base { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtransition: all 0.2s; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-width: 2px; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аfont-weight: 800; /* Extra Bold */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtext-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-base:hover { transform: scale(1.02); }
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-base:active { transform: scale(0.98); }
┬а┬а┬а┬а┬а┬а┬а┬а/* Color Button Glows - Enhanced Red/Yellow */
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-green { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а/* Green Bet Button - Border and text are now PRIMARY YELLOW */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbox-shadow: 0 0 15px rgba(255, 221, 0, 0.6); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-color: #FFDD00; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbackground-color: rgba(255, 221, 0, 0.2); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolor: #FFDD00;
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-red { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а/* Red Bet Button - Border and text are now PRIMARY RED/ORANGE */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbox-shadow: 0 0 15px rgba(255, 85, 0, 0.6); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-color: #FF5500; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbackground-color: rgba(255, 85, 0, 0.2);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolor: #FF5500;
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-purple { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а/* Violet Bet Button - Remains Purple */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbox-shadow: 0 0 15px rgba(187, 0, 255, 0.4); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-color: #BB00FF; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbackground-color: rgba(187, 0, 255, 0.2);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolor: #BB00FF;
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а/* Big/Small Buttons - Highlighting Yellow/Red Contrast */
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-size-big { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbox-shadow: 0 0 15px rgba(255, 221, 0, 0.6); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-color: #FFDD00; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbackground-color: rgba(255, 221, 0, 0.2);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolor: #FFDD00; /* Text is Yellow */
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а.bet-btn-size-small { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbox-shadow: 0 0 15px rgba(255, 85, 0, 0.6); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-color: #FF5500; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbackground-color: rgba(255, 85, 0, 0.2);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolor: #FF5500; /* Text is Red/Orange */
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а/* Timer Loading Animation */
┬а┬а┬а┬а┬а┬а┬а┬а@keyframes fadePulse {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а0%, 100% { opacity: 1; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а50% { opacity: 0.3; }
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а.timer-loading { animation: fadePulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
┬а┬а┬а┬а┬а┬а┬а┬а/* History Circle - Colors for Actual Results */
┬а┬а┬а┬а┬а┬а┬а┬а.history-circle {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аwidth: 28px; /* Slightly bigger */
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аheight: 28px;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder-radius: 50%;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аdisplay: inline-flex;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аalign-items: center;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аjustify-content: center;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аfont-size: 16px;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аfont-weight: bold;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcolor: #000; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbox-shadow: 0 0 8px rgba(255, 255, 255, 0.4);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аborder: 1px solid rgba(0, 0, 0, 0.2);
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а.history-green { background-color: #39FF14; box-shadow: 0 0 10px #39FF14; }
┬а┬а┬а┬а┬а┬а┬а┬а.history-red { background-color: #FF4444; box-shadow: 0 0 10px #FF4444; }
┬а┬а┬а┬а┬а┬а┬а┬а.history-purple { background-color: #BB00FF; box-shadow: 0 0 10px #BB00FF; }
┬а┬а┬а┬а┬а┬а┬а┬а.history-big { background-color: #FFDD00; box-shadow: 0 0 10px #FFDD00; } /* Yellow for Big */
┬а┬а┬а┬а┬а┬а┬а┬а.history-small { background-color: #FF5500; box-shadow: 0 0 10px #FF5500; } /* Red/Orange for Small */
┬а┬а┬а┬а</style>
</head>
<body class="bg-dark-bg min-h-screen flex flex-col items-center p-2 text-white font-sans">
┬а┬а┬а┬а<div class="w-full max-w-xl">
┬а┬а┬а┬а┬а┬а┬а┬а<!-- Header and User Info Bar -->
┬а┬а┬а┬а┬а┬а┬а┬а<header class="w-full mb-4 p-4 card-bg rounded-b-xl shadow-lg border-b-4 border-primary-red">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<h1 class="text-2xl font-black text-center text-primary-yellow text-yellow-glow mb-2 tracking-wider">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аVIBRANT PREDICTOR
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</h1>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex justify-between items-center text-sm mt-3 border-t border-gray-700 pt-3">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex flex-col items-start">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span class="font-light text-gray-400 text-xs">A/C ID:</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span id="user-id-display" class="text-sm font-semibold text-primary-yellow break-all">Loading...</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex flex-col items-end">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span class="font-light text-gray-400 text-xs">BALANCE (Pts):</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span id="user-balance" class="text-3xl font-extrabold text-primary-red text-red-glow">0.00</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div id="auth-status" class="text-xs text-gray-500 text-center mt-2">рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╣реЛ рд░рд╣рд╛ рд╣реИ...</div>
┬а┬а┬а┬а┬а┬а┬а┬а</header>
┬а┬а┬а┬а┬а┬а┬а┬а<!-- Timer and Cycle Info -->
┬а┬а┬а┬а┬а┬а┬а┬а<section class="w-full mb-4 p-4 card-bg rounded-xl border-2 border-primary-yellow shadow-2xl shadow-primary-yellow/20">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex justify-between items-center mb-3">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="text-lg font-semibold text-gray-300">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аCycle <span class="text-accent-purple text-purple-glow" id="current-cycle">---</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="text-sm font-light text-gray-400">Time Left:</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div id="timer" class="text-8xl font-mono font-extrabold text-center text-primary-yellow timer-loading mb-4">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а00:00
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Result History -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="border-t border-gray-800 pt-3">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<p class="text-xs text-gray-500 mb-2">LAST 10 RESULTS (Number & Type):</p>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div id="result-history" class="flex flex-wrap gap-3 justify-start min-h-[30px]">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span class="text-gray-600 text-sm">рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а</section>
┬а┬а┬а┬а┬а┬а┬а┬а<!-- Prediction/Betting Section -->
┬а┬а┬а┬а┬а┬а┬а┬а<main class="w-full p-4 card-bg rounded-xl border-2 border-primary-red shadow-2xl shadow-primary-red/20">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<h2 class="text-xl font-semibold mb-4 text-center text-primary-yellow text-yellow-glow">рдЕрдкрдирд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдПрдБ (Place Bet)</h2>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Bet Amount Selector -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="mb-5 p-3 rounded-lg bg-gray-900 border border-gray-700">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<p class="text-sm text-gray-400 mb-2">рджрд╛рдБрд╡ рд░рд╛рд╢рд┐ (Bet Amount):</p>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex items-center space-x-3">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<input type="number" id="bet-amount" value="10" min="1" 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclass="w-full p-3 rounded-lg bg-gray-800 text-white font-bold text-lg border border-gray-600 focus:ring-primary-yellow focus:border-primary-yellow focus:ring-2 appearance-none">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="changeBetAmount(10)" class="w-10 h-10 bg-primary-red hover:bg-red-600 rounded-full text-lg font-bold transition text-black">+10</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="changeBetAmount(-10)" class="w-10 h-10 bg-primary-red hover:bg-red-600 rounded-full text-lg font-bold transition text-black">-10</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex justify-between space-x-2 mt-2 text-xs">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="setBetAmount(10)" class="flex-1 py-1 bg-gray-800 hover:bg-gray-700 rounded-lg border border-gray-600">Min 10</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="setBetAmount(50)" class="flex-1 py-1 bg-gray-800 hover:bg-gray-700 rounded-lg border border-gray-600">50</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="setBetAmount(100)" class="flex-1 py-1 bg-gray-800 hover:bg-gray-700 rounded-lg border border-gray-600">100</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="setBetAmount('max')" class="flex-1 py-1 bg-red-900 hover:bg-red-800 rounded-lg border border-red-700 text-primary-yellow">MAX</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Color Buttons -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<p class="text-md font-semibold text-center mb-3 text-primary-yellow">Choose Color (x2.0 - x4.5)</p>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex justify-around space-x-2 mb-6">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Green Bet - Uses Yellow/Green Hues for high visibility -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="placeBet('Green')" id="btn-green"
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclass="bet-btn-base bet-btn-green flex-1 py-4 px-2 text-lg rounded-xl">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аGreen <span class="text-xs block font-light text-gray-300">1,3,7,9 + Half on 5</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Red Bet - Uses Primary Red/Orange Hues -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="placeBet('Red')" id="btn-red"
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclass="bet-btn-base bet-btn-red flex-1 py-4 px-2 text-lg rounded-xl">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аRed <span class="text-xs block font-light text-gray-300">2,4,6,8 + Half on 0</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Violet Bet - Retains Purple for distinction -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="placeBet('Violet')" id="btn-violet"
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclass="bet-btn-base bet-btn-purple flex-1 py-4 px-2 text-lg rounded-xl">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аViolet <span class="text-xs block font-light text-gray-300">0 & 5 (x4.5)</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Big/Small Buttons -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<p class="text-md font-semibold text-center mb-3 text-primary-red">Choose Size (x2.0)</p>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex justify-around space-x-2 mb-6">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- BIG - Uses Primary Yellow Hues -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="placeBet('Big')" id="btn-big"
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclass="bet-btn-base bet-btn-size-big flex-1 py-4 px-2 text-xl rounded-xl">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аBIG <span class="text-xs block font-light text-gray-300">5, 6, 7, 8, 9</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- SMALL - Uses Primary Red/Orange Hues -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="placeBet('Small')" id="btn-small"
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclass="bet-btn-base bet-btn-size-small flex-1 py-4 px-2 text-xl rounded-xl">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аSMALL <span class="text-xs block font-light text-gray-300">0, 1, 2, 3, 4</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<!-- Current Bets Display -->
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<h3 class="text-md font-semibold mt-4 text-gray-400 border-t border-gray-800 pt-3">рд╡рд░реНрддрдорд╛рди рджрд╛рд╡ (Current Bets)</h3>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div id="current-bets" class="text-sm text-gray-300 min-h-[50px] mt-2">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<p class="text-gray-500">Abhi koi daav nahi laga hai.</p>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а</main>
┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а<!-- Admin/Result Generator Section (Testing Only) -->
┬а┬а┬а┬а┬а┬а┬а┬а<section class="w-full mt-6 p-4 card-bg rounded-xl border border-red-800/50">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<h2 class="text-xl font-semibold mb-4 text-center text-primary-red text-red-glow">ADMIN (FORCE RESULT NUMBER 0-9)</h2>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="grid grid-cols-5 gap-2 text-sm">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(0)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">0</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(1)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">1</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(2)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">2</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(3)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">3</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(4)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">4</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(5)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">5</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(6)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">6</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(7)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">7</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(8)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">8</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult(9)" class="py-2 px-1 bg-gray-800 hover:bg-gray-700 rounded-lg text-white font-bold">9</button>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="generateResult('Reset')" class="w-full mt-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white font-bold">Reset/Next Cycle</button>
┬а┬а┬а┬а┬а┬а┬а┬а</section>
┬а┬а┬а┬а</div>
┬а┬а┬а┬а<!-- Custom Alert/Message Modal -->
┬а┬а┬а┬а<div id="message-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden">
┬а┬а┬а┬а┬а┬а┬а┬а<div class="bg-card-bg w-full max-w-xs rounded-xl p-6 text-center border-2 border-primary-yellow shadow-2xl shadow-primary-yellow/30">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<h3 id="modal-title" class="text-xl font-bold mb-4 text-primary-yellow text-yellow-glow">Sandesh</h3>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<p id="modal-content" class="text-gray-300 mb-6"></p>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<button onclick="closeMessageModal()" class="w-full py-2 bg-primary-red hover:bg-red-600 rounded-lg text-black font-bold transition">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аTheek Hai
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</button>
┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а</div>
┬а┬а┬а┬а<!-- Firebase SDKs -->
┬а┬а┬а┬а<script type="module">
┬а┬а┬а┬а┬а┬а┬а┬аimport { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
┬а┬а┬а┬а┬а┬а┬а┬аimport { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
┬а┬а┬а┬а┬а┬а┬а┬аimport { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, onSnapshot, collection, query, where, serverTimestamp, runTransaction, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
┬а┬а┬а┬а┬а┬а┬а┬аimport { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
┬а┬а┬а┬а┬а┬а┬а┬а// Global variables (Canvas environment provides these)
┬а┬а┬а┬а┬а┬а┬а┬аconst appId = typeof __app_id !== 'undefined' ? __app_id : 'color-size-predictor-id';
┬а┬а┬а┬а┬а┬а┬а┬аconst firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
┬а┬а┬а┬а┬а┬а┬а┬аconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
┬а┬а┬а┬а┬а┬а┬а┬аif (!firebaseConfig) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Firebase config is missing.");
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', 'Firebase Configuration nahi mili. App kaam nahi karega.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// 1. INITIALIZATION AND AUTHENTICATION
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬аsetLogLevel('Debug');
┬а┬а┬а┬а┬а┬а┬а┬аconst app = initializeApp(firebaseConfig);
┬а┬а┬а┬а┬а┬а┬а┬аconst db = getFirestore(app);
┬а┬а┬а┬а┬а┬а┬а┬аconst auth = getAuth(app);
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬аlet currentUserId = null;
┬а┬а┬а┬а┬а┬а┬а┬аlet userBalance = 0.00; 
┬а┬а┬а┬а┬а┬а┬а┬а// Firestore Path Constants
┬а┬а┬а┬а┬а┬а┬а┬аconst RESULTS_COLLECTION = `artifacts/${appId}/public/data/game_results`;
┬а┬а┬а┬а┬а┬а┬а┬аconst USERS_COLLECTION_BASE = `artifacts/${appId}/users/`;
┬а┬а┬а┬а┬а┬а┬а┬а// DOM Element References
┬а┬а┬а┬а┬а┬а┬а┬аconst authStatusEl = document.getElementById('auth-status');
┬а┬а┬а┬а┬а┬а┬а┬аconst userIdDisplayEl = document.getElementById('user-id-display');
┬а┬а┬а┬а┬а┬а┬а┬аconst userBalanceEl = document.getElementById('user-balance');
┬а┬а┬а┬а┬а┬а┬а┬аconst betAmountInput = document.getElementById('bet-amount');
┬а┬а┬а┬а┬а┬а┬а┬аconst timerEl = document.getElementById('timer');
┬а┬а┬а┬а┬а┬а┬а┬аconst currentCycleEl = document.getElementById('current-cycle');
┬а┬а┬а┬а┬а┬а┬а┬аconst resultHistoryEl = document.getElementById('result-history');
┬а┬а┬а┬а┬а┬а┬а┬а// Custom Modal functions (replacing alert/confirm)
┬а┬а┬а┬а┬а┬а┬а┬аfunction showCustomMessage(title, content) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аdocument.getElementById('modal-title').textContent = title;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аdocument.getElementById('modal-content').innerHTML = content;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аdocument.getElementById('message-modal').classList.remove('hidden');
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬аfunction closeMessageModal() {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аdocument.getElementById('message-modal').classList.add('hidden');
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬аwindow.closeMessageModal = closeMessageModal; // Global access
┬а┬а┬а┬а┬а┬а┬а┬а/** Firebase User Authentication */
┬а┬а┬а┬а┬а┬а┬а┬аasync function setupAuth() {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аauthStatusEl.textContent = 'User sign-in ho raha hai...';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtry {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (initialAuthToken) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait signInWithCustomToken(auth, initialAuthToken);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait signInAnonymously(auth);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аonAuthStateChanged(auth, (user) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (user) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcurrentUserId = user.uid;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserIdDisplayEl.textContent = currentUserId.substring(0, 8) + '...';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аauthStatusEl.textContent = 'Signed in successfully.';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsetupGameListeners();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аfetchUserBalance();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcurrentUserId = null;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserIdDisplayEl.textContent = 'Not Signed In';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аauthStatusEl.textContent = 'Authentication Failed!';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', 'Authentication mein samasya. Khel nahi chalega.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} catch (error) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Auth error:", error);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аauthStatusEl.textContent = 'Authentication Failed!';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Auth Error', `Authentication mein galti: ${error.message}`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// 2. USER BALANCE AND WALLET
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬аconst getWalletRef = (uid) => doc(db, USERS_COLLECTION_BASE + uid, 'wallet', 'main_wallet');
┬а┬а┬а┬а┬а┬а┬а┬аconst getBetsCollectionRef = (uid) => collection(db, USERS_COLLECTION_BASE + uid, 'bets');
┬а┬а┬а┬а┬а┬а┬а┬аconst getTransactionsCollectionRef = (uid) => collection(db, USERS_COLLECTION_BASE + uid, 'transactions');
┬а┬а┬а┬а┬а┬а┬а┬а/** Fetches user balance from Firestore or creates a new user document */
┬а┬а┬а┬а┬а┬а┬а┬аasync function fetchUserBalance() {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!currentUserId) return;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst userDocRef = getWalletRef(currentUserId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtry {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst docSnap = await getDoc(userDocRef);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (docSnap.exists()) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserBalance = docSnap.data().balance;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Create new user document with initial balance
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserBalance = 1000.00;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait setDoc(userDocRef, { balance: userBalance, userId: currentUserId, createdAt: serverTimestamp() });
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Welcome!', 'Aapko shuruaati balance 1000 points diya gaya hai.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserBalanceEl.textContent = userBalance.toFixed(2);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} catch (error) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Error fetching balance:", error);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Silent error in background
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а/** Updates local and displayed balance */
┬а┬а┬а┬а┬а┬а┬а┬аfunction updateLocalBalance(newBalance) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserBalance = newBalance;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserBalanceEl.textContent = userBalance.toFixed(2);
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а/** Transaction to update user balance (used for betting and settlement) */
┬а┬а┬а┬а┬а┬а┬а┬аasync function updateBalanceTransaction(amount, cycleId, reason) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!currentUserId) return false;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst userDocRef = getWalletRef(currentUserId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst logsCollectionRef = getTransactionsCollectionRef(currentUserId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtry {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst newBalance = await runTransaction(db, async (transaction) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst walletDoc = await transaction.get(userDocRef);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet currentBalance = walletDoc.exists() ? walletDoc.data().balance : 0;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst finalBalance = currentBalance + amount;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (finalBalance < 0) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аthrow new Error("Insufficient Funds");
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtransaction.set(userDocRef, { balance: finalBalance }, { merge: true });
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Add a transaction log
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtransaction.set(doc(logsCollectionRef), {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аamount: amount,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аnewBalance: finalBalance,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcycleId: cycleId,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreason: reason,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimestamp: serverTimestamp()
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn finalBalance;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аupdateLocalBalance(newBalance);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn true; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} catch (error) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Balance transaction failed:", error);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (error.message === "Insufficient Funds") {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', 'Balance kam hai. Daav nahi lag sakta.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', `Transaction failed: ${error.message}`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn false; 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// 3. GAME TIMER AND REAL-TIME UPDATES
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬аconst TIMER_DURATION_SEC = 60; // 60 seconds per cycle
┬а┬а┬а┬а┬а┬а┬а┬аconst CYCLE_DOC_PATH = `${RESULTS_COLLECTION}/current_state`; // Document for current game state
┬а┬а┬а┬а┬а┬а┬а┬аlet timerInterval = null;
┬а┬а┬а┬а┬а┬а┬а┬аlet currentCycleId = null;
┬а┬а┬а┬а┬а┬а┬а┬аlet lastResult = null;
┬а┬а┬а┬а┬а┬а┬а┬аlet isBettingOpen = true; 
┬а┬а┬а┬а┬а┬а┬а┬а/** Starts/Updates the countdown timer */
┬а┬а┬а┬а┬а┬а┬а┬аfunction updateTimer(startTime) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclearInterval(timerInterval);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.classList.remove('timer-loading');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerInterval = setInterval(() => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst now = Date.now();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst elapsed = Math.floor((now - startTime) / 1000);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet timeLeft = TIMER_DURATION_SEC - (elapsed % TIMER_DURATION_SEC);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (timeLeft < 0) timeLeft += TIMER_DURATION_SEC;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst minutes = Math.floor(timeLeft / 60);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst seconds = timeLeft % 60;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Betting Phase Control (Uses Red/Yellow accents)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (timeLeft <= 10) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.classList.add('text-red-glow');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.classList.remove('text-yellow-glow');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisBettingOpen = false;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else if (timeLeft <= 60 && timeLeft > 10) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.classList.remove('text-red-glow');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.classList.add('text-yellow-glow');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisBettingOpen = true;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Cycle ends 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (timeLeft <= 0) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аclearInterval(timerInterval);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.textContent = '00:00';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimerEl.classList.add('timer-loading');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisBettingOpen = false;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}, 1000);
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а/** Listens to the current game state from Firestore */
┬а┬а┬а┬а┬а┬а┬а┬аfunction setupGameListeners() {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst cycleDocRef = doc(db, CYCLE_DOC_PATH);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аonSnapshot(cycleDocRef, (docSnap) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (docSnap.exists()) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst data = docSnap.data();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Update Cycle ID and Timer
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst newCycleId = data.cycleId;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (newCycleId !== currentCycleId) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcurrentCycleId = newCycleId;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcurrentCycleEl.textContent = currentCycleId;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аupdateTimer(data.startTime.toMillis());
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Update Last Result (It is now a number 0-9)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst resultNumber = data.lastResult !== undefined && data.lastResult !== null ? parseInt(data.lastResult) : null;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (resultNumber !== null && resultNumber !== lastResult) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlastResult = resultNumber;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Trigger client-side settlement
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аprocessBetSettlement(data.lastCycleId, resultNumber); 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Update history in background
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsetTimeout(updateResultHistory, 2000);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Display user's current bets
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аdisplayCurrentCycleBets(data.cycleId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Setup Error', 'Game state document nahi mila. Admin se cycle shuru karne ko kahein.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а/** Maps the result number (0-9) to colors and size for history display */
┬а┬а┬а┬а┬а┬а┬а┬аfunction getResultDetails(number) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet color = 'Red';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet size = 'Small';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Size Logic
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (number >= 5) { size = 'Big'; } // 5, 6, 7, 8, 9 (5 numbers)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аelse { size = 'Small'; }┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// 0, 1, 2, 3, 4 (5 numbers)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Color Logic
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (number === 1 || number === 3 || number === 7 || number === 9) { color = 'Green'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аelse if (number === 0 || number === 5) { color = 'Violet'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Otherwise, it remains 'Red' (2, 4, 6, 8)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn { number, color, size };
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а/** Fetches and displays the last 10 results */
┬а┬а┬а┬а┬а┬а┬а┬аasync function updateResultHistory() {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst resultsRef = collection(db, RESULTS_COLLECTION);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Query for all documents that have a valid lastResult (number 0-9)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst q = query(resultsRef, where('lastResult', '!=', 'N/A'));
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtry {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst snapshot = await getDocs(q);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet history = [];
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsnapshot.forEach(doc => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst data = doc.data();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst resultNum = parseInt(data.lastResult);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!isNaN(resultNum) && data.lastCycleId) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аhistory.push({ result: resultNum, cycle: data.lastCycleId });
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аhistory.sort((a, b) => parseInt(b.cycle) - parseInt(a.cycle));
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst lastTen = history.slice(0, 10);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (lastTen.length === 0) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аresultHistoryEl.innerHTML = '<span class="text-gray-600 text-sm">Abhi koi result nahi hai.</span>';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аresultHistoryEl.innerHTML = lastTen.reverse().map(item => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst details = getResultDetails(item.result);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet colorClass = `history-${details.color.toLowerCase()}`;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet sizeClass = `history-${details.size.toLowerCase()}`;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn `
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="flex flex-col items-center gap-1">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="history-circle ${colorClass}" title="${details.color} | ${details.size}">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а${details.number}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<div class="history-circle w-5 h-5 text-sm ${sizeClass}">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а${details.size.charAt(0)}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</div>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а`;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}).join('');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} catch (error) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Error fetching history:", error);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аresultHistoryEl.innerHTML = '<span class="text-red-500 text-xs">History load nahi hui.</span>';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// 4. BETTING UI AND LOGIC
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// Bet Amount Controls
┬а┬а┬а┬а┬а┬а┬а┬аwindow.changeBetAmount = (delta) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet amount = parseFloat(betAmountInput.value);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аamount = Math.max(1, amount + delta); // Minimum bet 1
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetAmountInput.value = amount.toFixed(0);
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬аwindow.setBetAmount = (value) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (value === 'max') {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetAmountInput.value = Math.floor(userBalance).toFixed(0);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetAmountInput.value = value.toFixed(0);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬аwindow.placeBet = async (type) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!currentUserId || !currentCycleId) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', 'Pehle login/cycle shuru hone ka intezaar karein.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!isBettingOpen) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('STOP', 'Daav lagane ka samay band ho gaya hai. Agle cycle ka intezaar karein.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst amount = parseFloat(betAmountInput.value);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (amount < 1 || amount > userBalance) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', `Daav rashi 1 se ${userBalance.toFixed(2)} ke beech honi chahiye.`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// 1. User ke account se amount kaato (Debit)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst debitSuccess = await updateBalanceTransaction(-amount, currentCycleId, `Bet on ${type}`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (debitSuccess) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtry {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// 2. Bet document Firestore mein add karo
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst betsCollectionRef = getBetsCollectionRef(currentUserId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait addDoc(betsCollectionRef, {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аuserId: currentUserId,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcycleId: currentCycleId,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtype: type, // Stores 'Green', 'Red', 'Violet', 'Big', or 'Small'
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аamount: amount,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstatus: 'Pending', 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtimestamp: serverTimestamp()
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Daav Laga!', `${type} par ${amount} points ka daav lag gaya hai.`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} catch (error) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Error placing bet:", error);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// If bet document fails to save, refund the balance
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait updateBalanceTransaction(amount, currentCycleId, `Bet placement failed refund`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Error', 'Daav lagane mein samasya. Points wapas kiye gaye.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а/** Shows the user's bets for the current cycle */
┬а┬а┬а┬а┬а┬а┬а┬аfunction displayCurrentCycleBets(cycleId) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!currentUserId) return;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst betsCollectionRef = getBetsCollectionRef(currentUserId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Show only pending bets in the current cycle
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst q = query(betsCollectionRef, where("cycleId", "==", cycleId), where("status", "==", "Pending"));
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аonSnapshot(q, (snapshot) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst betsEl = document.getElementById('current-bets');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (snapshot.empty) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetsEl.innerHTML = '<p class="text-gray-500">Abhi koi daav nahi laga hai.</p>';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet totalBet = 0;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet betsHtml = '<ul class="space-y-1">';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsnapshot.forEach(doc => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst bet = doc.data();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtotalBet += bet.amount;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet colorClass = 'text-white';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet borderColor = 'border-gray-500';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (bet.type === 'Green') { colorClass = 'text-actual-green'; borderColor = 'border-actual-green'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аelse if (bet.type === 'Red') { colorClass = 'text-actual-red'; borderColor = 'border-actual-red'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аelse if (bet.type === 'Violet') { colorClass = 'text-accent-purple'; borderColor = 'border-accent-purple'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аelse if (bet.type === 'Big') { colorClass = 'text-primary-yellow'; borderColor = 'border-primary-yellow'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аelse if (bet.type === 'Small') { colorClass = 'text-primary-red'; borderColor = 'border-primary-red'; }
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetsHtml += `
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<li class="flex justify-between items-center bg-gray-900/50 p-2 rounded-lg border-l-4 ${borderColor}">
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span class="font-semibold ${colorClass}">${bet.type}</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span class="text-sm text-gray-400">(${bet.amount.toFixed(2)} Pts)</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а<span class="text-primary-yellow">Pending...</span>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а</li>
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а`;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetsHtml += '</ul>';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetsEl.innerHTML = betsHtml;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аbetsEl.insertAdjacentHTML('beforeend', `<p class="mt-2 font-bold text-lg text-gray-200">Total Daav: ${totalBet.toFixed(2)} Pts</p>`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а/**
┬а┬а┬а┬а┬а┬а┬а┬а┬а* After a result is announced, check user's bets and credit winnings.
┬а┬а┬а┬а┬а┬а┬а┬а┬а* The result is a number (0-9).
┬а┬а┬а┬а┬а┬а┬а┬а┬а*/
┬а┬а┬а┬а┬а┬а┬а┬аasync function processBetSettlement(cycleId, resultNumber) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (!currentUserId) return;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst details = getResultDetails(resultNumber);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Result!', `Cycle #${cycleId} ka result aagaya hai: <span class="font-extrabold text-3xl text-yellow-glow">${resultNumber}</span> (${details.color} | ${details.size}). Daavon ki jaanch ho rahi hai...`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst betsCollectionRef = getBetsCollectionRef(currentUserId);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Query for pending bets in the completed cycle
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst q = query(betsCollectionRef, 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аwhere("cycleId", "==", cycleId), 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аwhere("status", "==", "Pending"));
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst snapshot = await getDocs(q);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet totalProfit = 0;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsnapshot.forEach(async (docSnap) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst bet = docSnap.data();
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst docRef = doc(db, betsCollectionRef.path, docSnap.id);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet payout = 0;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet status = 'Lost';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet profit = 0;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// --- Payout Logic based on Result Number ---
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst betType = bet.type;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst amount = bet.amount;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet isWinner = false;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet multiplier = 2.0;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (betType === 'Big' || betType === 'Small') {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Big/Small Payout (2x)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif ((betType === 'Big' && resultNumber >= 5) || (betType === 'Small' && resultNumber <= 4)) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisWinner = true;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Color Payouts (Green, Red, Violet)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (betType === 'Green' && (resultNumber === 1 || resultNumber === 3 || resultNumber === 7 || resultNumber === 9)) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisWinner = true;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else if (betType === 'Red' && (resultNumber === 2 || resultNumber === 4 || resultNumber === 6 || resultNumber === 8)) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisWinner = true;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else if (betType === 'Violet' && (resultNumber === 0 || resultNumber === 5)) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аisWinner = true;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аmultiplier = 4.5;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Partial Refund (on 0 and 5)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (resultNumber === 0 && betType === 'Red') {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Red bet on 0 (Violet tie) -> Half refund
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аpayout = amount * 0.5;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аprofit = payout; // Crediting 0.5x is the refund, since -1x was debited
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstatus = 'Partial Refund';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else if (resultNumber === 5 && betType === 'Green') {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Green bet on 5 (Violet tie) -> Half refund
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аpayout = amount * 0.5;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аprofit = payout;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstatus = 'Partial Refund';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (isWinner) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аpayout = amount * multiplier;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аprofit = payout - amount; // Total winnings - Original Bet (since original was already debited)
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstatus = 'Won';
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (profit > 0) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst creditSuccess = await updateBalanceTransaction(profit, cycleId, `${status} on ${betType}`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (creditSuccess) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtotalProfit += profit;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Update bet status
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait updateDoc(docRef, { 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstatus: status, 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аresult: resultNumber, 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аpayout: payout,
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsettledAt: serverTimestamp() 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (totalProfit > 0) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('ЁЯе│ Jeet Gaye!', `Aapne Cycle #${cycleId} mein kul <span class="text-3xl font-extrabold text-actual-green text-yellow-glow">${totalProfit.toFixed(2)}</span> points ka profit kamaya!`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} else {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Result', `Cycle #${cycleId} ka result ${resultNumber} (${details.color} | ${details.size}) raha. Next time try karein!`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а// Wait for 5 seconds for visual confirmation, then close message
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аsetTimeout(closeMessageModal, 5000);
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// 5. ADMIN/TEST FUNCTIONALITY (Force Result Generator)
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬аwindow.generateResult = async (input) => {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlet lastCycleId = currentCycleId ? parseInt(currentCycleId) : 10000;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst cycleDocRef = doc(db, RESULTS_COLLECTION, 'current_state');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (input === 'Reset') {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait setDoc(cycleDocRef, {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcycleId: (lastCycleId + 1).toString(),
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstartTime: serverTimestamp(),
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlastResult: 'N/A', // Using N/A for reset/no result
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlastCycleId: lastCycleId.toString()
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Admin Reset', 'Naya Cycle ID shuru kiya gaya.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst resultNumber = parseInt(input);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аif (isNaN(resultNumber) || resultNumber < 0 || resultNumber > 9) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Admin Error', 'Kripya 0 se 9 tak ek valid number chunein.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аreturn;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconst nextCycleId = lastCycleId + 1;
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аtry {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аawait setDoc(cycleDocRef, {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аcycleId: nextCycleId.toString(),
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аstartTime: serverTimestamp(),
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlastResult: resultNumber.toString(), // Store as string for Firestore consistency
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аlastCycleId: lastCycleId.toString() 
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а});
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Admin Success', `Cycle ${lastCycleId} ka result ${resultNumber} set kiya gaya. Naya cycle ${nextCycleId} shuru.`);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а} catch (error) {
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аconsole.error("Admin error:", error);
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬аshowCustomMessage('Admin Error', 'Result set karne mein galti aayi.');
┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а}
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬а// RUN THE APP
┬а┬а┬а┬а┬а┬а┬а┬а// -------------------------------------------------------------
┬а┬а┬а┬а┬а┬а┬а┬аsetupAuth();
┬а┬а┬а┬а┬а┬а┬а┬аupdateResultHistory(); 
┬а┬а┬а┬а</script>
</body>
</html>
